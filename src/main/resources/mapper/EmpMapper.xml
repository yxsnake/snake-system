<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.snake.system.mapper.EmpMapper">
    
    <resultMap id="empResult" type="com.snake.system.model.entity.Emp">
        <id property="empId" column="emp_id" />
        <result property="realName" column="real_name" />
        <result property="avatar" column="avatar" />
        <result property="email" column="email" />
        <result property="phone" column="phone" />
        <result property="gender" column="gender" />
        <result property="tenantId" column="tenant_id" />
        <result property="supperAdmin" column="supper_admin" />
        <result property="createTime" column="create_time" />
        <result property="createUserId" column="create_user_id" />
        <result property="createUserName" column="create_user_name" />
        <result property="updateTime" column="update_time" />
        <result property="updateUserId" column="update_user_id" />
        <result property="updateUserName" column="update_user_name" />
    </resultMap>

    <select id="countByCondition" parameterType="map" resultType="java.lang.Long">
        SELECT
            count(1)
        FROM
            emp t1,
            emp_org t2
        WHERE
            t1.emp_id = t2.emp_id
        <if test="params.orgId !=null and params.orgId !=''">
            AND t2.org_id = #{params.orgId}
        </if>
        <if test="params.gender !=null ">
            AND t1.gender = #{params.gender}
        </if>
        <if test="params.realName !=null and params.realName !=''">
            AND t1.real_name like concat('%',#{params.realName},'%')
        </if>
        <if test="params.phone !=null and params.phone !=''">
            AND t1.phone like concat('%',#{params.phone},'%')
        </if>
    </select>

    <select id="findByConditionWithPage" parameterType="map"  resultMap="empResult" >
        SELECT
            t1.`emp_id`,
            t1.`real_name`,
            t1.`avatar`,
            t1.`email`,
            t1.`phone`,
            t1.`gender`,
            t1.`tenant_id`,
            t1.`supper_admin`,
            t1.`create_time`,
            t1.`create_user_id`,
            t1.`create_user_name`,
            t1.`update_time`,
            t1.`update_user_id`,
            t1.`update_user_name`
        FROM
            emp t1,
            emp_org t2
        WHERE
            t1.emp_id = t2.emp_id
        <if test="params.orgId !=null and params.orgId !=''">
            AND t2.org_id = #{params.orgId}
        </if>
        <if test="params.gender !=null ">
            AND t1.gender = #{params.gender}
        </if>
        <if test="params.realName !=null and params.realName !=''">
            AND t1.real_name like concat('%',#{params.realName},'%')
        </if>
        <if test="params.phone !=null and params.phone !=''">
            AND t1.phone like concat('%',#{params.phone},'%')
        </if>
        LIMIT #{params.offset}, #{params.pageSize}
    </select>
</mapper>
